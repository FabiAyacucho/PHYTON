



// Array de productos
const productos = [
  {
    id: "producto-1",
      titulo: 'Producto 1',
      descripcion: 'Descripción del Producto 1',
      precio: 3699.00,
      imagen: '../images/1.jpg',
      categoria: {
        nombre:'Juguetes',
        id:'Juguetes'
      }
    },
    {
      id: "producto-2",
      titulo: 'Producto 2',
      descripcion: 'Descripción del Producto 2',
      precio: 2554.00,
      imagen: '../images/2.jpg',
      categoria: {
        nombre:'Alimento',
        id:'Alimento'
      }
    },
    
      {
        id: "producto-3",
        titulo: 'Producto 3',
        descripcion: 'Descripción del Producto 3',
        precio: 2554.00,
        imagen: '../images/3.jpg',
        categoria: {
          nombre:'Alimento',
          id:'Alimento'
        }
      },
      
      {
        id: "producto-4",
        titulo: 'Producto 4',
        descripcion: 'Descripción del Producto 4',
        precio: 1150.00,
        imagen: '../images/4.jpg',
        categoria: {
          nombre:'Alimento',
          id:'Alimento'
        }
      },
      {
        id: "producto-5",
        titulo: 'Producto 5',
        descripcion: 'Descripción del Producto 5',
        precio: 1250.00,
        imagen: '../images/5.jpg',
        categoria: {
          nombre:'Alimento',
          id:'Alimento'
        }
      },
      {
        id: "producto-6",
        titulo: 'Producto 6',
        descripcion: 'Descripción del Producto 6',
        precio: 2554.00,
        imagen: '../images/6.jpg',
        categoria: {
          nombre:'Alimento',
          id:'Alimento'
        }
      },
      
      {
        id: "producto-7",
        titulo: 'Producto ',
        descripcion: 'Descripción del Producto 7',
        precio: 1150.00,
        imagen: '../images/7.jpg',
        categoria: {
          nombre:'Accesorio',
          id:'Accesorio'
        }
      },
      {
        id: "producto-8",
        titulo: 'Producto 8',
        descripcion: 'Descripción del Producto 8',
        precio: 1250.00,
        imagen: '../images/8.jpg',
        categoria: {
          nombre:'Alimento',
          id:'Alimento'
        }
      },
      {
        id: "producto-9",
        titulo: 'Producto 9',
        descripcion: 'Descripción del Producto 9',
        precio: 1250.00,
        imagen: '../images/9.jpg',
        categoria: {
          nombre:'Alimento',
          id:'Alimento'
        }
      },
      
      
        {
          id: "producto-10",
          titulo: 'Producto 10',
          descripcion: 'Descripción del Producto 10',
          precio: 987.00,
          imagen: '../images/10.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-11",
          titulo: 'Producto 11',
          descripcion: 'Descripción del Producto 11',
          precio: 987.00,
          imagen: '../images/11.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-12",
          titulo: 'Producto 12',
          descripcion: 'Descripción del Producto 12',
          precio: 987.00,
          imagen: '../images/12.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-13",
          titulo: 'Producto 13',
          descripcion: 'Descripción del Producto 13',
          precio: 987.00,
          imagen: '../images/13.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-14",
          titulo: 'Producto 14',
          descripcion: 'Descripción del Producto 14',
          precio: 987.00,
          imagen: '../images/14.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-15",
          titulo: 'Producto 15',
          descripcion: 'Descripción del Producto 15',
          precio: 2654.00,
          imagen: '../images/15.jpg',
          categoria: {
            nombre:'Juguetes',
            id:'Juguetes'
          }
        },
        {
          id: "producto-16",
          titulo: 'Producto 16',
          descripcion: 'Descripción del Producto 16',
          precio: 2350.00,
          imagen: '../images/16.jpg',
          categoria: {
            nombre:'Juguetes',
            id:'Juguetes'
          }
        },
        {
          id: "producto-17",
            titulo: 'Producto 17',
            descripcion: 'Descripción del Producto 17',
            precio: 3699.00,
            imagen: '../images/17.jpg',
            categoria: {
              nombre:'Juguetes',
              id:'Juguetes'
            }
          },
          {
            id: "producto-18",
            titulo: 'Producto 18',
            descripcion: 'Descripción del Producto 18',
            precio: 3350.00,
            imagen: '../images/18.jpg',
            categoria: {
              nombre:'Juguetes',
              id:'Juguetes'
            }
          },
          
        
        {
          id: "producto-19",
          titulo: 'Producto 19',
          descripcion: 'Descripción del Producto 19',
          precio: 2654.00,
          imagen: '../images/19.jpg',
          categoria: {
            nombre:'Juguetes',
            id:'Juguetes'
          }
        },
        {
          id: "producto-20",
          titulo: 'Producto 20',
          descripcion: 'Descripción del Producto 20',
          precio: 2350.00,
          imagen: '../images/20.jpg',
          categoria: {
            nombre:'Juguetes',
            id:'Juguetes'
          }
        },
        {
          id: "producto-21",
            titulo: 'Producto 21',
            descripcion: 'Descripción del Producto 21',
            precio: 3699.00,
            imagen: '../images/21.jpg',
            categoria: {
              nombre:'Juguetes',
              id:'Juguetes'
            }
          },
          {
            id: "producto-22",
            titulo: 'Producto 22',
            descripcion: 'Descripción del Producto 22',
            precio: 3350.00,
            imagen: '../images/22.jpg',
            categoria: {
              nombre:'Juguetes',
              id:'Juguetes'
            }
          },
          {
            id: "producto-23",
            titulo: 'Producto 23',
            descripcion: 'Descripción del Producto 23',
            precio: 2304.00,
            imagen: '../images/23.jpg',
            categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
           }
         },
         {
          id: "producto-23",
          titulo: 'Producto 23',
          descripcion: 'Descripción del Producto 23',
          precio: 2304.00,
          imagen: '../images/23.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-24",
          titulo: 'Producto 24',
          descripcion: 'Descripción del Producto 24',
          precio: 1985.00,
          imagen: '../images/24.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-25",
          titulo: 'Producto 25',
          descripcion: 'Descripción del Producto 25',
          precio: 1266.00,
          imagen: '../images/25.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-26",
          titulo: 'Producto 26',
          descripcion: 'Descripción del Producto 26',
          precio: 987.00,
          imagen: '../images/26.jpg',
          categoria: {
            nombre:'Accesorio',
            id:'Accesorio'
          }
        },
        {
          id: "producto-27",
          titulo: 'Producto 27',
          descripcion: 'Descripción del Producto 27',
          precio: 2039.00,
          imagen: '../images/27.jpg',
          categoria: {
            nombre:'Alimento',
            id:'Alimento'
          }
        },
        {
          id: "producto-28",
          titulo: 'Producto 28',
          descripcion: 'Descripción del Producto 28',
          precio: 1040.00,
          imagen: '../images/28.jpg',
          categoria: {
            nombre:'Alimento',
            id:'Alimento'
          }
        },
        {
          id: "producto-29",
          titulo: 'Producto 29',
          descripcion: 'Descripción del Producto 29',
          precio: 2699.00,
          imagen: '../images/29.jpg',
          categoria: {
            nombre:'Alimento',
            id:'Alimento'
          }
        },
  
  ];
  
  const contenedorProductos = document.querySelector("#contenedor-productos");
  const botonesCategorias = document.querySelectorAll(".btn-categoria");
  const tituloPrincipal = document.querySelector("#titulo-principal");
  let botonesAgregar  = document.querySelectorAll(".producto-agregar");
  const numerito = document.querySelector("#numerito");
  const botonesPaginacion = document.querySelectorAll(".page-link");
  const pageContainer = document.querySelector(".pagination");
  
  
  function cargarproductos(productosElegidos) {
    contenedorProductos.innerHTML = "";
  
    productosElegidos.forEach((producto) => {
      const div = document.createElement("div");
      div.classList.add("productos");
      div.innerHTML = `
        <div class="cart">
          <div class="product">
            <img src="${producto.imagen}" alt="${producto.titulo}">
            <div class="abajo-card">
              <h3 class="descripcion">${producto.descripcion}</h3>
              <div class="precio">$${producto.precio}</div>
              <button class="producto-agregar" id="${producto.id}">Agregar</button>
            </div>
          </div>
        </div> 
      `;
  
      contenedorProductos.append(div);
    });
    actualizarBotonesAgregar();
  }
  let productosFiltrados = productos;


  botonesCategorias.forEach((boton) => {
    boton.addEventListener("click", (e) => {
      botonesCategorias.forEach((boton) => boton.classList.remove("active"));
      e.currentTarget.classList.add("active");
  
      if (e.currentTarget.id !== "todos") {
        productosFiltrados = productos.filter(
          (producto) => producto.categoria.id === e.currentTarget.id
        );
        tituloPrincipal.innerText = e.currentTarget.innerText;
      } else {
        productosFiltrados = productos;
        tituloPrincipal.innerText = "Todos los productos";
      }
  
      cambiarPagina(paginaActual, productosFiltrados);
    });
  });
  
  function actualizarBotonesAgregar(){
    botonesAgregar = document.querySelectorAll(".producto-agregar");
    
    botonesAgregar.forEach(boton => {
      boton.addEventListener("click", agregarAlCarrito);
    });
  };
  
  let productosEnCarrito;
  
  const productosEnCarritoLS = JSON.parse(localStorage.getItem("productos-en-carrito"));
  
  if(productosEnCarritoLS){
    productosEnCarrito =  productosEnCarritoLS;
    actualizarNumerito();
  }else{
    productosEnCarrito = [];
  }
  
  
  
  function agregarAlCarrito(e) {
  
    const idBoton = e.currentTarget.id;
    const productoAgregado = productos.find(producto => producto.id == idBoton)
     
    if(productosEnCarrito.some(producto => producto.id ===idBoton)){
      const index = productosEnCarrito.findIndex(producto => producto.id ===idBoton);
      productosEnCarrito[index].cantidad++;
      
    }else{
      productoAgregado.cantidad = 1;
      productosEnCarrito.push(productoAgregado);
    }
    actualizarNumerito();
  
    localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito));
  };
  
  
  
  function actualizarNumerito(){
    let nuevoNumerito = productosEnCarrito.reduce((acc,producto) => acc + producto.cantidad, 0);
    numerito.innerText = nuevoNumerito;
  }
  
  



  
const productosPorPagina = 8; // Número de productos por página
let paginaActual = 1; // Página actual

function renderizarProductosPorPagina(productos, pagina) {
    const startIndex = (pagina - 1) * productosPorPagina;
    const endIndex = pagina * productosPorPagina;
    const productosPaginaActual = productos.slice(startIndex, endIndex);

    cargarproductos(productosPaginaActual);
}

function handlePaginationClick(e) {
    e.preventDefault();
    const textoBoton = e.target.innerText;

    if (textoBoton === "Anterior") {
        cambiarPagina(paginaActual - 1, productosFiltrados);
    } else if (textoBoton === "Siguiente") {
        cambiarPagina(paginaActual + 1, productosFiltrados);
    } else {
        cambiarPagina(parseInt(textoBoton), productosFiltrados);
    }
}


botonesPaginacion.forEach((boton) => {
    boton.addEventListener("click", handlePaginationClick);
});

function cambiarPagina(pagina, productosFiltrados) {
    const totalPages = Math.ceil(productosFiltrados.length / productosPorPagina);

    if (pagina < 1) {
        pagina = 1;
    } else if (pagina > totalPages) {
        pagina = totalPages;
    }

    renderizarProductosPorPagina(productosFiltrados, pagina);

    paginaActual = pagina;

    actualizarPaginacion(productosFiltrados);
}

function actualizarPaginacion(totalProductos) {
    const totalPages = Math.ceil(totalProductos.length / productosPorPagina);
    const pageList = pageContainer.querySelector("ul.pagination");
   

    // Asegúrate de que el bucle solo itere sobre los números de página
    for (let i = 1; i <= totalPages; i++) {
        const listItem = document.createElement("li");
        listItem.classList.add("page-item");
        const link = document.createElement("a");
        link.classList.add("page-link");
        link.innerText = i;
        listItem.appendChild(link);
       
    }

    const prevButton = document.createElement("li");
    prevButton.classList.add("page-item", "prev-page");
    const prevLink = document.createElement("a");
    prevLink.classList.add("page-link");
    prevLink.innerText = "Anterior";
    prevButton.appendChild(prevLink);
    

    const nextButton = document.createElement("li");
    nextButton.classList.add("page-item", "next-page");
    const nextLink = document.createElement("a");
    nextLink.classList.add("page-link");
    nextLink.innerText = "Siguiente";
    nextButton.appendChild(nextLink);
    

    // Elimina los event listeners antes de agregarlos nuevamente
    botonesPaginacion.forEach((boton) => {
        boton.removeEventListener("click", handlePaginationClick);
    });

    botonesPaginacion.forEach((boton) => {
        boton.addEventListener("click", handlePaginationClick);
    });

    const pageText = document.querySelector(".page-info");
    pageText.innerText = `Página ${paginaActual} de ${totalPages}`;
}


renderizarProductosPorPagina(productos, paginaActual);